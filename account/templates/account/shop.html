{% extends 'base.html' %}

{% block title %}Shop with us - My bookshop{% endblock %}

{% block content %}

{% load static %}

<div class="my-10 h-64 flex justify-center items-center relative">
    <div class="inset-0 bg-black opacity-60 absolute z-10"></div>
    <div class="aos text-center relative z-20" data-aos="flip-left"
     data-aos-easing="ease-out-cubic"
     data-aos-duration="2000">
     <h2 class="mb-2 text-3xl lg:text-4xl text-white font-bold leading-tight">Shop With Us</h2>
        <p class="text-lg text-white mx-auto">Explore new books</p>
    </div>
    <div class="inset-0 absolute z-0">  
    <img src="{% static 'images/shopbg/shopbg (134).jpg' %}" class="w-full h-full object-fill object-center">
    </div> 
</div>


 <!-- Search Form -->
 <form method="GET" action="{% url 'shop' %}" class="mb-6 flex justify-center">
    <div class="relative w-full max-w-md">
        <input type="text" name="q" placeholder="Search books..." value="{{ search_query }}" class="w-full border border-gray-300 rounded-lg py-3 px-4 pr-12 focus:outline-none focus:ring-2 focus:ring-blue-500 transition duration-300 ease-in-out">
        <button type="submit" class="absolute right-0 top-0 mt-2 mr-2 bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-lg transition duration-300 ease-in-out">
            Search
        </button>
    </div>
</form> 


<div class="flex flex-col m-8 sm:flex-col md:flex-row sm:mx-5 sm:my-4 justify-center mb-6 space-y-4 md:space-y-0 md:space-x-8 lg:space-x-12">


    <!-- All Books Button -->
    <a href="{% url 'shop' %}" class="flex items-center px-4 py-2 bg-gray-100 text-gray-700 rounded-full shadow-lg hover:bg-gray-200 transition duration-200 ease-in-out transform hover:scale-105">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2 text-gray-700" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 5h18M3 10h18M3 15h18M3 20h18" />
        </svg>
        <span class="font-semibold">All Books</span>
    </a>

    <!-- Free Books Button -->
    <a href="{% url 'shop' %}?free=true" class="flex items-center px-4 py-2 bg-green-100 text-green-700 rounded-full shadow-lg hover:bg-green-200 transition duration-200 ease-in-out transform hover:scale-105">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2 text-green-700" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6 0a9 9 0 11-18 0 9 9 0 0118 0z" />
        </svg>
        <span class="font-semibold">Free Books</span>
    </a>

    <!-- Paid Books Button -->
    <a href="{% url 'shop' %}?free=false" class="flex items-center px-4 py-2 bg-blue-100 text-blue-700 rounded-full shadow-lg hover:bg-blue-200 transition duration-200 ease-in-out transform hover:scale-105">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2 text-blue-700" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 10h18M12 2l6 6-6 6" />
        </svg>
        <span class="font-semibold">Paid Books</span>
    </a>


     <!-- featured Books Button -->
     <a href="{% url 'shop' %}?featured=true" class="flex items-center px-4 py-2 bg-red-200 text-blue-700 rounded-full shadow-lg hover:bg-yellow-200 transition duration-200 ease-in-out transform hover:scale-105">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2 text-blue-700" fill="currentColor" viewBox="0 0 24 24">
            <path d="M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"/>
        </svg>
        <span class="font-semibold">Featured Books</span>
    </a>
    
</div>



<div class="container mx-auto py-8 px-4 flex gap-8 flex-col md:flex-row">

    <aside class="w-full md:w-1/4 mb-6 md:mb-0">
        <div class="bg-white p-6 rounded-xl shadow-lg">
            <!-- Filter Heading -->
            <h2 class="text-2xl font-bold text-gray-800 mb-6">Filter by Category</h2>
    
            <!-- Category Links -->
            <ul class="space-y-4">
                <li>
                    <!-- Link to All Books (no category filter) -->
                    <a href="{% url 'shop' %}" class="flex items-center px-4 py-3 bg-blue-50 text-blue-600 rounded-lg hover:bg-blue-100 transition-colors duration-300 ease-in-out shadow-sm">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2 text-blue-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 12h14M12 5l7 7-7 7" />
                        </svg>
                        All Categories
                    </a>
                </li>
                {% for category in categories %}
                <li>
                    <a href="{% url 'shop' %}?category={{ category.id }}" class="flex items-center px-4 py-3 bg-blue-50 text-blue-600 rounded-lg hover:bg-blue-100 transition-colors duration-300 ease-in-out shadow-sm">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2 text-blue-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 12h14M12 5l7 7-7 7" />
                        </svg>
                        {{ category.name }}
                    </a>
                </li>
                {% endfor %}
            </ul>
        </div>

        <div class="text-center flex justify-center items-center  my-8">
            <a href="{% url 'recommend_books' %}" class="max-w-md flex items-center px-6 py-3 bg-gradient-to-r from-green-400 to-blue-500 text-white font-semibold rounded-lg shadow-md hover:shadow-lg hover:from-green-500 hover:to-blue-600 transition-transform transform hover:scale-105">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 mr-3" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16l-4-4m0 0l4-4m-4 4h16" />
                </svg>
                Book Recommendations
            </a>
        </div>
    </aside>
    
    

<main class="flex-1">
     <!-- Check for no results -->
  {% if no_results %}
  <div class="bg-gray-50 border border-dashed border-blue-500 rounded-lg py-8 px-6 text-center shadow-md mb-6">
      <h3 class="text-3xl font-bold text-gray-700 mb-4">No results found!</h3>
      <p class="text-gray-600 text-lg">We couldn't find any books matching your search for <strong class="text-yellow-600">"{{ search_query }}"</strong>. Try searching for something else or check out the latest books!</p>
      <a href="{% url 'catalogbook_list' %}" class="mt-6 inline-block bg-blue-500 hover:bg-blue-600 text-white font-bold py-3 px-6 rounded-lg shadow-lg transition duration-200 ease-in-out">
          Explore All Books
      </a>
  </div>
  {% else %}
  {% comment %} <div class="bg-gray-50 border border-dashed border-blue-500 rounded-lg py-8 px-6 text-center shadow-md mb-6">
     <h3 class="text-3xl font-bold text-gray-700 mb-4">Showing results for <strong class="text-yellow-600">"{{ search_query }}"</strong>!</h3>
     <p class="text-gray-600 text-lg">Few free to also explore our entire books by clicking on the button bellow</p>
     <a href="{% url 'catalog:book_list' %}" class="mt-6 inline-block bg-blue-500 hover:bg-blue-600 text-white font-bold py-3 px-6 rounded-lg shadow-lg transition duration-200 ease-in-out">
         Explore All Books
     </a>
 </div> {% endcomment %}
  {% endif %}

<div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12">
    <div class="grid grid-cols-1 gap-y-8 sm:grid-cols-2 gap-x-6 lg:grid-cols-3 xl:grid-cols-4">
        {% for book in books %}
        <div class="group relative bg-white shadow-md rounded-lg overflow-hidden transition-transform duration-200 transform hover:scale-105">
            
            <a href="{% url 'catalog:book_detail' book.pk %}">
                {% if book.is_free %}

                {% else %}   
               <a href="{% url 'add_to_cart' book.pk %}" class=" bg-gray-100 hover:bg-blue-400 transition duration-200">
                   <div
                   class="bg-gray-100  hover:bg-blue-400 transition duration-200 w-10 h-10 flex items-center justify-center rounded-full cursor-pointer absolute top-4 right-16">
                   <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewBox="0 0 512 512">
                       <path
                         d="M164.96 300.004h.024c.02 0 .04-.004.059-.004H437a15.003 15.003 0 0 0 14.422-10.879l60-210a15.003 15.003 0 0 0-2.445-13.152A15.006 15.006 0 0 0 497 60H130.367l-10.722-48.254A15.003 15.003 0 0 0 105 0H15C6.715 0 0 6.715 0 15s6.715 15 15 15h77.969c1.898 8.55 51.312 230.918 54.156 243.71C131.184 280.64 120 296.536 120 315c0 24.812 20.188 45 45 45h272c8.285 0 15-6.715 15-15s-6.715-15-15-15H165c-8.27 0-15-6.73-15-15 0-8.258 6.707-14.977 14.96-14.996zM477.114 90l-51.43 180H177.032l-40-180zM150 405c0 24.813 20.188 45 45 45s45-20.188 45-45-20.188-45-45-45-45 20.188-45 45zm45-15c8.27 0 15 6.73 15 15s-6.73 15-15 15-15-6.73-15-15 6.73-15 15-15zm167 15c0 24.813 20.188 45 45 45s45-20.188 45-45-20.188-45-45-45-45 20.188-45 45zm45-15c8.27 0 15 6.73 15 15s-6.73 15-15 15-15-6.73-15-15 6.73-15 15-15zm0 0"
                         data-original="#000000"></path>
                     </svg>
               </div>
               </a>
               <a href="{% url 'add_to_wishlist' book.pk %}" class=" bg-gray-100 hover:bg-red-500 transition duration-200">
                   <div
               class="bg-gray-100  hover:bg-red-500 transition duration-200 w-10 h-10 flex items-center justify-center rounded-full cursor-pointer absolute top-4 right-4">
               
               <svg class="h-6 w-6 text-gray-500 hover:text-white" fill="currentColor" viewBox="0 0 24 24">
                   <path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c2.09 0 4.08.99 5.5 2.55C14.42 3.99 16.41 3 18.5 3 21.58 3 24 5.42 24 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"/>
               </svg>
               </a>
             </div>
             {% endif %}
                <div class="w-full h-72 bg-gray-200 overflow-hidden">
                    {% if book.image %}
                        <img src="{{ book.image.url }}" alt="{{ book.title }}" class="w-full h-full object-cover object-center">
                    {% else %}
                        <div class="w-full h-full flex items-center justify-center">
                            <svg class="h-20 w-20 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253" />
                            </svg>
                        </div>
                    {% endif %}
                </div>
            </a>
            
            <div class="p-4">
                <h3 class="text-lg font-semibold text-gray-800">
                    <a href="{% url 'catalog:book_detail' book.pk %}">
                        {{ book.title }}
                    </a>
                </h3>
                <p class="mt-1 text-sm text-gray-500">by {{ book.author }}</p>
    
                <!-- Pricing Section -->
                <div class="mt-2">
                    {% if book.is_free %}
                        <p class="text-lg font-medium text-green-600">Free</p>
                    {% else %}
                        {% if book.discount_price %}
                            <h4 class="text-lg text-gray-800 font-bold">GH$ {{ book.discount_price }} <strike class="text-gray-400 ml-2 font-medium">GH$ {{ book.price }}</strike></h4>
                        {% else %}
                            <p class="text-lg font-medium text-gray-900">GH$ {{ book.price }}</p>
                        {% endif %}
                    {% endif %}
                </div>
    
                <!-- Action Buttons -->
                <div class="mt-4 flex items-center space-x-2">
                    {% if book.is_free %}

                            <a href="{% url 'catalog:book_detail' book.pk %}"
                            class="w-full rounded-md flex items-center justify-center gap-2 py-3 bg-blue-500 text-white font-semibold rounded-xltext-white hover:font-bold">
                            <svg class="w-5 h-5 mr-1" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v-4a4 4 0 014-4h8a4 4 0 014 4v4M16 12l-4 4m0 0l-4-4m4 4V4" />
                            </svg>
                            Download</a>
                    {% else %}
                    <a href="{% url 'order:buy_now' book.pk %}"
                    class="w-full rounded-md flex items-center justify-center gap-2 py-3 bg-blue-500 text-white font-semibold rounded-xltext-white hover:font-bold">
                    <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M7 4h-2v2h2v-2zm0 4h-2v2h2v-2zm0 4h-2v2h2v-2zm4-8h-2v2h2v-2zm0 4h-2v2h2v-2zm0 4h-2v2h2v-2zm4-8h-2v2h2v-2zm0 4h-2v2h2v-2zm0 4h-2v2h2v-2zm4-8h-2v2h2v-2zm0 4h-2v2h2v-2zm0 4h-2v2h2v-2zm2-10h-2v16h2v-16zm-22-4h2v16h-2v-16zm22 0h2v2h-2v-2zm-4 0h2v16h-2v-16zm-14 20v2h20v-2h-20z"/>
                      </svg>
                      
                    Buy Now</a>

                    {% endif %}
                </div>
    
                <!-- View Details Link -->
                <div class="mt-2">
                    <a href="{% url 'catalog:book_detail' book.pk %}" class="text-sm text-blue-600 hover:underline">View Details</a>
                </div>
            </div>
        </div>
        {% empty %}
        <div class="col-span-1 sm:col-span-2 lg:col-span-3 flex justify-center">
            <div class="text-center bg-red-50 text-red-700 p-6 rounded-lg shadow-md mt-8">
                <h2 class="text-2xl font-bold mb-2">No books found</h2>
                <p class="text-lg">We couldnâ€™t find any books that match your search or filter criteria. Please try different options.</p>
            </div>
        </div>
        {% endfor %}
    </div>

     <!-- Pagination -->
     <div class="mt-8 flex justify-center">
        <nav aria-label="Page navigation">
            <ul class="inline-flex space-x-2">
                <!-- Previous Page Link -->
                {% if books.has_previous %}
                <li>
                    <a href="?page={{ books.previous_page_number }}&q={{ search_query }}" class="bg-gray-200 hover:bg-gray-300 text-gray-600 font-bold py-2 px-4 rounded-lg">Previous</a>
                </li>
                {% else %}
                <li>
                    <span class="bg-gray-300 text-gray-400 font-bold py-2 px-4 rounded-lg">Previous</span>
                </li>
                {% endif %}

                <!-- Page Numbers -->
                {% for num in books.paginator.page_range %}
                    {% if books.number == num %}
                    <li>
                        <span class="bg-blue-500 text-white font-bold py-2 px-4 rounded-lg">{{ num }}</span>
                    </li>
                    {% else %}
                    <li>
                        <a href="?page={{ num }}&q={{ search_query }}" class="bg-gray-200 hover:bg-gray-300 text-gray-600 font-bold py-2 px-4 rounded-lg">{{ num }}</a>
                    </li>
                    {% endif %}
                {% endfor %}

                <!-- Next Page Link -->
                {% if books.has_next %}
                <li>
                    <a href="?page={{ books.next_page_number }}&q={{ search_query }}" class="bg-gray-200 hover:bg-gray-300 text-gray-600 font-bold py-2 px-4 rounded-lg">Next</a>
                </li>
                {% else %}
                <li>
                    <span class="bg-gray-300 text-gray-400 font-bold py-2 px-4 rounded-lg">Next</span>
                </li>
                {% endif %}
            </ul>
        </nav>
    </div>
    </main
    </div>
    </div>
{% endblock %}
    





